# Secure Mergin Maps installation

For security and privacy reasons Mergin Maps deployments should enable HTTPS secured connection via certificate file.

We provide a template configuration file [ssl-proxy.conf](https://github.com/MerginMaps/server/blob/master/ssl-proxy.conf) as base for your costumization.

Let's have a quick look at the main sections:

``` shell
    server {
        listen              443 ssl;
        server_name         merginmaps.company.com; # FIXME
        client_max_body_size 4G;
        
        ...
```

Here we enable SSL via the defaul `443` port and configure name-based HTTPS server via `server_name`. Here you should change this according to your target server name.

We don't recommend setting a `client_max_body_size` higher than specified, because that might lead to timeouts while uploading your data to Mergin Maps.

Next, you need to point your certificate files to NGINX configuration. This is done on the next lines on the secured configuration:

``` shell
    ...
    ssl_certificate_key /etc/letsencrypt/live/merginmaps.company.com/privkey.pem; # FIXME
    ssl_certificate     /etc/letsencrypt/live/merginmaps.company.com/fullchain.pem; # FIXME
    ...
```

The above example uses automated keys generated by Certbot. For more information, visit [CertBot](https://certbot.eff.org/instructions) website and check how you can generate your own keys.

Lastly, adjust the provided nginx `docker compose` deployment file, on the following [section](https://github.com/MerginMaps/server/blob/master/docker-compose.yml#L95):

``` shell
       - "8080:8080"
     volumes:
       - ./projects:/data  # map data dir to host
-      - ./nginx.conf:/etc/nginx/conf.d/default.conf
+      - ./ssl-proxy.conf:/etc/nginx/conf.d/default.conf
       - ./logs:/var/log/nginx/
     networks:
       - merginmaps
```
